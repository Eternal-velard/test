<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–æ–≤—ã–π –æ—Ç—á–µ—Ç: –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –æ–±—ä–µ–∫—Ç–∞</title>
    <link rel="stylesheet" href="styless.css"> 
    <script src="menuLoader.js"></script>
    <style>
        /* ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===== */
        :root {
            --primary-color: rgb(37 99 235);
            --primary-hover: rgb(29 78 216);
            --error-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #2ecc71;

            /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–≤–∞–ª–∞ */
            --footer-bg: #fff;
            --footer-text: #6b7280;
            --footer-link: #4b5563;
            --footer-link-hover: #111827;
        }

        /* ===== –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò –°–¢–†–ê–ù–ò–¶–´ ===== */
        body {
            margin: 0;
            font-family: 'Suisse Intl', sans-serif;
            background-color: #EBF0F6;
            background: #eef2f7 url("https://i.postimg.cc/wxXJJCnh/bg-lk.jpg");
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* ===== –ö–û–ù–¢–ï–ô–ù–ï–† –ö–û–ù–¢–ï–ù–¢–ê ===== */
        .container {
            padding: 20px;
            flex: 1 0 auto;
            display: flex;
            align-items: center;
        }

        /* ===== –ë–õ–û–ö–ò –°–û–î–ï–†–ñ–ò–ú–û–ì–û ===== */
        .content-block {
            max-width: 1100px;
            margin: 20px auto;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #fff;
        }

        h1 { margin-bottom: 20px; }

        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            resize: vertical;
            margin-bottom: 20px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }

        textarea:focus { outline: none; border-color: var(--primary-color); }

        /* –±–ª–æ–∫ —Å–æ–≥–ª–∞—Å–∏—è */
        .consent {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: #fafafa;
            margin-top: 16px;
            margin-bottom: 16px;
            font-size: 14px;
            line-height: 1.35;
        }
        .consent input { margin-top: 2px; }

        .button-container { text-align: center; margin-top: 20px; }

        .custom-button {
            display: block;
            padding: 12px 30px;
            background-color: #465BF8;
            color: white;
            border: none;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-align: right;
            margin-left: auto;
        }

        .custom-button:hover { background-color: var(--primary-hover); }
        .custom-button:disabled { background-color: #bdc3c7; cursor: not-allowed; }

        .status-message {
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
            padding: 10px;
            border-radius: 4px;
        }
        .status-new { color: var(--primary-color); background-color: rgba(37, 99, 235, 0.1); }
        .status-in_progress { color: var(--warning-color); background-color: rgba(243, 156, 18, 0.1); }
        .status-completed { color: var(--success-color); background-color: rgba(46, 204, 113, 0.1); }
        .status-error { color: var(--error-color); background-color: rgba(231, 76, 60, 0.1); }

        .task-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            font-size: 14px;
        }
        .task-id { font-family: monospace; color: var(--primary-color); word-break: break-all; }

        .retry-button { background-color: var(--warning-color); margin-left: 10px; }
        .retry-button:hover { background-color: #e67e22; }

        .coming-soon {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            margin-bottom: 15px;
            font-style: italic;
        }

        /* ===== –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –≠–ö–°–ü–ï–†–¢–ù–û–ô –û–¶–ï–ù–ö–ò ===== */

        /* –°–µ—Ç–∫–∞ —Ñ–æ—Ä–º—ã: —Å–ª–µ–≤–∞ –≤–≤–æ–¥—ã, —Å–ø—Ä–∞–≤–∞ —Ä–µ–∑—é–º–µ */
        .expert-form-grid {
            display: grid;
            grid-template-columns: 2fr 1.4fr;
            gap: 24px;
            align-items: flex-start;
        }

        .expert-form-section,
        .expert-preview-section {
            width: 100%;
        }

        .expert-field-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }

        .expert-input-group {
            margin-bottom: 16px;
        }

        .expert-text-input,
        .expert-number-input,
        .expert-select-input,
        .expert-file-input {
            width: 100%;
            box-sizing: border-box;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: #ffffff;
        }

        .expert-text-input:focus,
        .expert-number-input:focus,
        .expert-select-input:focus,
        .expert-file-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.12);
        }

        .expert-area-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .expert-area-row .expert-number-input {
            flex: 1 1 auto;
        }

        .expert-area-row .expert-select-input {
            width: 120px;
            flex: 0 0 auto;
        }

        /* –†–µ–∑—é–º–µ —Å–ø—Ä–∞–≤–∞ */
        .expert-preview-card {
            background-color: #f9fafb;
            border-radius: 6px;
            padding: 14px 16px;
            border: 1px solid #e5e7eb;
            font-size: 13px;
            margin-top: 21px;
        }

        .expert-preview-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .expert-preview-line {
            margin-bottom: 4px;
        }

        .expert-preview-label {
            font-weight: 500;
        }

        .expert-preview-value.expert-muted {
            color: #6b7280;
            font-style: italic;
        }

        /* —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */
        .expert-results-block {
            margin-top: 26px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }

        .expert-results-block h2 {
            margin: 0 0 10px 0;
            font-size: 18px;
        }

        .expert-results-empty {
            font-size: 14px;
            color: #6b7280;
            font-style: italic;
        }

        #expert-results-list {
            display: none;
            margin-top: 8px;
            gap: 12px;
        }

        .expert-result-card {
            background-color: #f9fafb;
            border-radius: 6px;
            padding: 12px 14px;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 13px;
        }

        .expert-result-header {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            font-weight: 600;
        }

        .expert-result-location {
            font-size: 12px;
            color: #6b7280;
        }

        .expert-result-meta {
            font-size: 12px;
            color: #4b5563;
        }

        .expert-result-note {
            margin-top: 2px;
            font-size: 12px;
            color: #6b7280;
        }

        .expert-result-link {
            margin-top: 4px;
            font-size: 12px;
        }

        .expert-result-link a {
            color: #2563eb;
            text-decoration: none;
        }

        .expert-result-link a:hover {
            text-decoration: underline;
        }

        @media (max-width: 960px) {
            .expert-form-grid {
                grid-template-columns: 1fr;
            }
            .expert-preview-card {
                margin-top: 0;
            }
        }

        @media (min-width: 900px) {
            #expert-results-list {
                display: grid;
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (max-width: 899px) {
            #expert-results-list {
                display: grid;
                grid-template-columns: 1fr;
            }
        }

        /* ===== –®–ê–ü–ö–ê –°–ê–ô–¢–ê –ò –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */

        .menu {
            background-color: #fff;
            display: flex;
            align-items: center;
            padding: 30px 20px;
            position: relative;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .menu nav {
            display: flex;
            flex-direction: row;
            gap: 20px;
            margin-left: auto;
            flex-wrap: wrap;
            align-items: center;
        }

        .menu nav a {
            text-decoration: none;
            color: #333333;
            font-size: 16px;
            display: block;
            padding: 8px 12px;
            transition: background-color 0.3s ease;
            border-radius: 4px;
        }

        .menu nav a:hover {
            background-color: #f5f5f5;
        }

        nav a[href="exit.html"] {
            border: 2px solid #D9DBE7;
            border-radius: 0px;
            padding: 10px 50px;
            color: #656882;
            font-size: 10px;
            background-color: transparent;
            transition: all 0.3s ease;
        }

        .menu-button {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            margin-left: auto;
            padding: 8px;
        }

        /* ===== –ü–û–î–í–ê–õ –°–ê–ô–¢–ê ===== */

        .site-footer {
            background: var(--footer-bg);
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, Inter, Arial, sans-serif;
            color: var(--footer-text);
            font-size: 14px;
            line-height: 1.4;
            flex-shrink: 0;
        }

        .site-footer .footer-inner {
            margin: 0 auto;
            padding: 16px 24px;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            gap: 24px;
        }

        .footer-left {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
            gap: 16px;
            min-width: 260px;
        }

        .footer-logo img {
            display: block;
            height: 50px;
            width: auto;
        }

        .footer-tagline {
            margin: 0;
            font-size: 12px;
            color: #9aa3ae;
            text-align: left;
        }

        .footer-nav {
            display: flex;
            gap: 24px;
            justify-content: center;
            white-space: nowrap;
        }

        .footer-nav a {
            color: var(--footer-link);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
        }

        .footer-nav a:hover {
            color: var(--footer-link-hover);
            text-decoration: underline;
        }

        .footer-right {
            text-align: right;
            color: #9aa3ae;
            font-size: 12px;
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨: –ú–ï–ù–Æ ===== */
        @media all and (max-width: 1060px) {
            .menu-button {
                display: block;
            }

            .menu nav {
                display: none;
                width: 100%;
            }

            .menu nav.active {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: #fff;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                padding: 10px 0;
            }
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨: –ü–û–î–í–ê–õ ===== */
        @media (max-width: 860px) {
            .site-footer .footer-inner {
                grid-template-columns: 1fr;
                gap: 12px;
                text-align: center;
            }

            .footer-left {
                justify-content: center;
                grid-template-columns: 1fr;
                text-align: center;
            }

            .footer-tagline {
                text-align: center;
            }

            .footer-right {
                text-align: center;
            }

            .footer-nav {
                flex-wrap: wrap;
                gap: 16px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- –ú–µ–Ω—é -->
    <div id="menu-container"></div>

    <div class="container">
        <!-- –ë–ª–æ–∫ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ -->
        <div class="content-block">
            <h1>–í—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É üîé</h1>

            <!-- –°–µ—Ç–∫–∞: —Å–ª–µ–≤–∞ –≤–≤–æ–¥—ã, —Å–ø—Ä–∞–≤–∞ —Ä–µ–∑—é–º–µ -->
            <div class="expert-form-grid">
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –≤—Å–µ –≤–≤–æ–¥—ã -->
                <div class="expert-form-section">
                    <div class="expert-input-group">
                        <label for="procedure-description" class="expert-field-label">
                            –û–ø–∏—Å–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ <span style="color:#ef4444;">*</span>
                        </label>
                        <textarea
                            id="procedure-description"
                            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ –ø–∞–Ω–µ–ª—å–Ω–æ–º –¥–æ–º–µ, 5 —ç—Ç–∞–∂ –∏–∑ 9, —Ö–æ—Ä–æ—à–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ..."
                        ></textarea>
                    </div>

                    <div class="expert-input-group">
                        <label for="expert-address" class="expert-field-label">–ê–¥—Ä–µ—Å (–µ—Å–ª–∏ –µ—Å—Ç—å)</label>
                        <input
                            type="text"
                            id="expert-address"
                            class="expert-text-input"
                            placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º"
                        />
                    </div>

                    <div class="expert-input-group">
                        <label for="expert-area" class="expert-field-label">–ü–ª–æ—â–∞–¥—å (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞)</label>
                        <div class="expert-area-row">
                            <input
                                type="number"
                                id="expert-area"
                                class="expert-number-input"
                                min="1"
                                step="0.1"
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 54"
                            />
                            <select id="expert-area-unit" class="expert-select-input">
                                <option value="sqm" selected>–∫–≤. –º</option>
                                <option value="hectare">–≥–∞</option>
                            </select>
                        </div>
                    </div>

                    <div class="expert-input-group">
                        <label for="expert-photo" class="expert-field-label">–§–æ—Ç–æ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)</label>
                        <input
                            type="file"
                            id="expert-photo"
                            class="expert-file-input"
                            accept="image/*"
                        />
                    </div>
                </div>

                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ä–µ–∑—é–º–µ -->
                <div class="expert-preview-section">
                    <div class="expert-preview-card">
                        <div class="expert-preview-title">–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ</div>

                        <div class="expert-preview-line">
                            <span class="expert-preview-label">–û–ø–∏—Å–∞–Ω–∏–µ:</span>
                            <span id="expert-preview-description" class="expert-preview-value expert-muted">
                                –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ.
                            </span>
                        </div>

                        <div class="expert-preview-line">
                            <span class="expert-preview-label">–ê–¥—Ä–µ—Å:</span>
                            <span id="expert-preview-address" class="expert-preview-value expert-muted">
                                –ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω.
                            </span>
                        </div>

                        <div class="expert-preview-line">
                            <span class="expert-preview-label">–ü–ª–æ—â–∞–¥—å:</span>
                            <span id="expert-preview-area" class="expert-preview-value expert-muted">
                                –ü–ª–æ—â–∞–¥—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞.
                            </span>
                        </div>

                        <div class="expert-preview-line">
                            <span class="expert-preview-label">–§–æ—Ç–æ:</span>
                            <span id="expert-preview-photo" class="expert-preview-value expert-muted">
                                –§–æ—Ç–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ.
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- —á–µ–∫–±–æ–∫—Å —Å–æ–≥–ª–∞—Å–∏—è (—Å—Ç–∞—Ä—ã–π –∫–ª–∞—Å—Å/ID) -->
            <div class="consent">
                <input type="checkbox" id="procedure-consent-checkbox" />
                <label for="procedure-consent-checkbox">
                    –Ø –¥–∞—é –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç—á—ë—Ç–∞ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ
                    –≤ —Å–µ—Ç–∏ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å—Å—ã–ª–∫–µ, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –∫—Ä—É–≥–æ–º –ª–∏—Ü.
                    –°–æ–≥–ª–∞—Å–∏–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç –±–µ—Å—Å—Ä–æ—á–Ω–æ –¥–æ –µ–≥–æ –æ—Ç–∑—ã–≤–∞. –Ø –∑–Ω–∞—é, —á—Ç–æ –º–æ–≥—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –æ—Ç–æ–∑–≤–∞—Ç—å —ç—Ç–æ —Å–æ–≥–ª–∞—Å–∏–µ ‚Äî
                    —É–¥–∞–ª–∏–≤ –æ—Ç—á—ë—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ¬´–ú–æ–∏ –æ—Ç—á–µ—Ç—ã¬ª.
                </label>
            </div>

            <div id="procedure-status-message" class="status-message" style="display: none;"></div>

            <div id="procedure-task-info" class="task-info" style="display: none;">
                <strong>–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ç—á–µ—Ç:</strong>
                <span class="task-id" id="procedure-task-id"></span>
            </div>

            <div class="button-container">
                <button class="custom-button" id="procedure-analyze-button" disabled>
                    –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É
                </button>
            </div>

            <!-- –ë–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ -->
            <div class="expert-results-block" id="expert-results-block">
                <h2>–ü–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</h2>
                <div id="expert-results-empty" class="expert-results-empty">
                    –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –æ—Ç–º–µ—Ç—å—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É.
                </div>
                <div id="expert-results-list"></div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <div id="footer-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // –°—Ç–∞—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            const descriptionEl = document.getElementById('procedure-description');
            const consentCheckbox = document.getElementById('procedure-consent-checkbox');
            const analyzeButton = document.getElementById('procedure-analyze-button');
            const statusMessageEl = document.getElementById('procedure-status-message');

            // –ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            const addressEl = document.getElementById('expert-address');
            const areaEl = document.getElementById('expert-area');
            const areaUnitEl = document.getElementById('expert-area-unit');
            const photoEl = document.getElementById('expert-photo');

            const previewDescriptionEl = document.getElementById('expert-preview-description');
            const previewAddressEl = document.getElementById('expert-preview-address');
            const previewAreaEl = document.getElementById('expert-preview-area');
            const previewPhotoEl = document.getElementById('expert-preview-photo');

            const resultsEmptyEl = document.getElementById('expert-results-empty');
            const resultsListEl = document.getElementById('expert-results-list');

            function formatNumber(num) {
                return num.toLocaleString('ru-RU', {
                    maximumFractionDigits: 0
                });
            }

            function updateButtonState() {
                const hasDescription = descriptionEl.value.trim().length > 0;
                const hasConsent = consentCheckbox.checked;
                analyzeButton.disabled = !(hasDescription && hasConsent);
            }

            function updatePreview() {
                const desc = descriptionEl.value.trim();
                const addr = addressEl.value.trim();
                const areaValue = areaEl.value.trim();
                const unit = areaUnitEl.value;
                const file = photoEl.files && photoEl.files[0];

                // –û–ø–∏—Å–∞–Ω–∏–µ
                if (desc) {
                    const shortened =
                        desc.length > 160 ? desc.slice(0, 160).trim() + '‚Ä¶' : desc;
                    previewDescriptionEl.textContent = shortened;
                    previewDescriptionEl.classList.remove('expert-muted');
                } else {
                    previewDescriptionEl.textContent = '–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ.';
                    previewDescriptionEl.classList.add('expert-muted');
                }

                // –ê–¥—Ä–µ—Å
                if (addr) {
                    previewAddressEl.textContent = addr;
                    previewAddressEl.classList.remove('expert-muted');
                } else {
                    previewAddressEl.textContent = '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω.';
                    previewAddressEl.classList.add('expert-muted');
                }

                // –ü–ª–æ—â–∞–¥—å
                if (areaValue) {
                    const unitLabel = unit === 'hectare' ? '–≥–∞' : '–∫–≤. –º';
                    previewAreaEl.textContent = areaValue + ' ' + unitLabel;
                    previewAreaEl.classList.remove('expert-muted');
                } else {
                    previewAreaEl.textContent = '–ü–ª–æ—â–∞–¥—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞.';
                    previewAreaEl.classList.add('expert-muted');
                }

                // –§–æ—Ç–æ
                if (file) {
                    previewPhotoEl.textContent =
                        file.name + (file.type ? ' (' + file.type + ')' : '');
                    previewPhotoEl.classList.remove('expert-muted');
                } else {
                    previewPhotoEl.textContent = '–§–æ—Ç–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ.';
                    previewPhotoEl.classList.add('expert-muted');
                }
            }

            function generateResults() {
                const desc = descriptionEl.value.trim();
                const addr = addressEl.value.trim();
                const areaRaw = parseFloat(areaEl.value.replace(',', '.'));
                const unit = areaUnitEl.value;

                const hasArea = !isNaN(areaRaw) && areaRaw > 0;
                const unitLabel = unit === 'hectare' ? '–≥–∞' : '–∫–≤. –º';

                const baseArea = hasArea ? areaRaw : 50 + Math.random() * 40;
                const basePricePerUnit = 80000 + Math.random() * 60000;

                const variants = [
                    { label: '–û–±—ä–µ–∫—Ç ‚Ññ1', areaFactor: 0.9, priceFactor: 0.95 },
                    { label: '–û–±—ä–µ–∫—Ç ‚Ññ2', areaFactor: 1.0, priceFactor: 1.0 },
                    { label: '–û–±—ä–µ–∫—Ç ‚Ññ3', areaFactor: 1.1, priceFactor: 1.05 }
                ];

                const descSnippet = desc
                    ? (desc.length > 120 ? desc.slice(0, 120).trim() + '‚Ä¶' : desc)
                    : '–û–ø–∏—Å–∞–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.';

                const addrBase = addr || '—Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–∞—è –ª–æ–∫–∞—Ü–∏—è';

                const cardsHtml = variants
                    .map((variant, index) => {
                        const area = baseArea * variant.areaFactor;
                        const pricePerUnit = basePricePerUnit * variant.priceFactor;
                        const totalPrice = area * pricePerUnit;

                        const title = variant.label;
                        const location =
                            index === 0
                                ? addrBase
                                : index === 1
                                ? addrBase + ' (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 1‚Äì2 –∫–º)'
                                : addrBase + ' (–±–ª–∏–∑–ª–µ–∂–∞—â–∏–π —Ä–∞–π–æ–Ω)';

                        const areaText = area.toFixed(1) + ' ' + unitLabel;
                        const pricePerUnitText =
                            formatNumber(Math.round(pricePerUnit)) + ' ‚ÇΩ / ' + unitLabel;
                        const totalPriceText =
                            formatNumber(Math.round(totalPrice)) + ' ‚ÇΩ';

                        const objectId = 'OBJ-' + (1001 + index);
                        const objectUrl = '#object-' + objectId;

                        return `
                            <div class="expert-result-card">
                                <div class="expert-result-header">
                                    <div>${title}</div>
                                    <div>${totalPriceText}</div>
                                </div>
                                <div class="expert-result-location">${location}</div>
                                <div class="expert-result-meta">
                                    –ü–ª–æ—â–∞–¥—å: ${areaText} ¬∑ –û—Ü–µ–Ω–∫–∞: ${pricePerUnitText}
                                </div>
                                <div class="expert-result-note">
                                    –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: ${descSnippet}
                                </div>
                                <div class="expert-result-link">
                                    –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç:
                                    <a href="${objectUrl}" onclick="return false;">
                                        ${objectUrl}
                                    </a>
                                </div>
                            </div>
                        `;
                    })
                    .join('');

                resultsListEl.innerHTML = cardsHtml;
                resultsEmptyEl.style.display = 'none';
                resultsListEl.style.display = 'grid';

                // —Å—Ç–∞—Ç—É—Å
                statusMessageEl.textContent = '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã.';
                statusMessageEl.className = 'status-message status-completed';
                statusMessageEl.style.display = 'block';
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            descriptionEl.addEventListener('input', function () {
                updateButtonState();
                updatePreview();
            });

            consentCheckbox.addEventListener('change', updateButtonState);
            addressEl.addEventListener('input', updatePreview);
            areaEl.addEventListener('input', updatePreview);
            areaUnitEl.addEventListener('change', updatePreview);
            photoEl.addEventListener('change', updatePreview);

            analyzeButton.addEventListener('click', function () {
                if (analyzeButton.disabled) return;
                generateResults();
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            updateButtonState();
            updatePreview();
        });
    </script>
</body>
</html>
